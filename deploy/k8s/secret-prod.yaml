apiVersion: v1
kind: Secret
metadata:
  name: workflow-platform-secrets
  namespace: workflow-platform-prod
type: Opaque
stringData:
  # 数据库凭证
  # ⚠️ 警告：生产环境必须使用强密码！
  SPRING_DATASOURCE_USERNAME: "platform_prod"
  SPRING_DATASOURCE_PASSWORD: "CHANGE_ME_PROD_DB_PASSWORD_VERY_STRONG_64_CHARS_MINIMUM"
  
  # Redis 凭证
  SPRING_REDIS_PASSWORD: "CHANGE_ME_PROD_REDIS_PASSWORD_VERY_STRONG_64_CHARS"
  
  # JWT 密钥（256-bit）
  # ⚠️ 必须使用加密安全的随机生成器生成
  # 生成命令: openssl rand -base64 32
  JWT_SECRET: "CHANGE_ME_PROD_JWT_SECRET_256_BIT_KEY_MUST_BE_UNIQUE_AND_STRONG"
  
  # 加密密钥（32 字节）
  # ⚠️ 必须使用加密安全的随机生成器生成
  # 生成命令: openssl rand -base64 32 | cut -c1-32
  ENCRYPTION_SECRET_KEY: "CHANGE_ME_PROD_ENCRYPTION_32CH"

---
# ⚠️⚠️⚠️ 生产环境安全注意事项 ⚠️⚠️⚠️
#
# 1. 密码要求：
#    - 数据库密码：至少 64 字符
#    - Redis 密码：至少 64 字符
#    - 必须包含大小写字母、数字、特殊字符
#    - 不能包含字典单词或常见模式
#
# 2. 密钥生成：
#    - JWT Secret: openssl rand -base64 32
#    - Encryption Key: openssl rand -base64 32 | cut -c1-32
#    - 必须在安全的环境中生成
#    - 每个环境使用不同的密钥
#
# 3. 密钥管理：
#    - 使用密钥管理服务（如 AWS KMS, Azure Key Vault, HashiCorp Vault）
#    - 定期轮换密钥（建议每 90 天）
#    - 记录密钥轮换历史
#
# 4. 访问控制：
#    - 限制对此 Secret 的访问权限
#    - 使用 RBAC 控制谁可以读取 Secret
#    - 启用审计日志记录所有访问
#
# 5. 部署流程：
#    - 不要将此文件提交到版本控制系统
#    - 使用 CI/CD 管道从密钥管理服务注入
#    - 部署后立即删除本地副本
#    - 使用加密的通信通道传输
#
# 6. 监控和审计：
#    - 启用 K8s 审计日志
#    - 监控 Secret 的访问和修改
#    - 设置告警通知异常访问
#
# 7. 备份和恢复：
#    - 将密钥备份到安全的离线存储
#    - 制定密钥丢失的恢复计划
#    - 定期测试恢复流程
